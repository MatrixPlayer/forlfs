AUX_SOURCE_DIRECTORY(. SRC_LIST)
AUX_SOURCE_DIRECTORY(alg SRC_ALG)
AUX_SOURCE_DIRECTORY(engine SRC_ENGINE)
AUX_SOURCE_DIRECTORY(io SRC_IO)
AUX_SOURCE_DIRECTORY(model SRC_MODEL)
AUX_SOURCE_DIRECTORY(network SRC_NETWORK)
AUX_SOURCE_DIRECTORY(processor SRC_PROCESSOR)
AUX_SOURCE_DIRECTORY(vis SRC_VIS)

#LIST(APPEND SRC_LIST ${SRC_ALG} ${SRC_ENGINE} ${SRC_IO} ${SRC_MODEL} ${SRC_NETWORK} ${SRC_PROCESSOR} ${SRC_VIS})

#ADD_EXECUTABLE(${PROJECT_NAME} ${SRC_LIST})

#TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${LIBS})

#INSTALL(TARGETS ${PROJECT_NAME} RUNTIME DESTINATION ${PROJECT_SOURCE_DIR}/bin/${CMAKE_BUILD_TYPE})

file(GLOB_RECURSE SRC_FILES *.cpp *.c *.cc)
set(PROJECT_ENGINE_LIB ${PROJECT_NAME_STR}_engine)
add_library(${PROJECT_ENGINE_LIB} ${SRC_FILES})

target_link_libraries(${PROJECT_ENGINE_LIB} ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(${PROJECT_ENGINE_LIB} ${FREETYPE_LIBRARIES})
target_link_libraries(${PROJECT_ENGINE_LIB} ${JSONCPP_LIBRARIES})
target_link_libraries(${PROJECT_ENGINE_LIB} ${GLOG_LIBRARIES})
target_link_libraries(${PROJECT_ENGINE_LIB} ${OpenCV_LIBS})
target_link_libraries(${PROJECT_ENGINE_LIB} ${PROTOBUF_LIBRARY})
target_link_libraries(${PROJECT_ENGINE_LIB} ${DLIB_LIBRARY})
target_link_libraries(${PROJECT_ENGINE_LIB} ${Caffe_DEP_LIBRARIES})
target_link_libraries(${PROJECT_ENGINE_LIB} ${PROJECT_NAME_STR}_utils)

IF(ENABLE_CUDA)
    set(CUDA_NVCC_FLAGS ${CMAKE_CXX_FLAGS_DEBUG};${CUDA_NVCC_FLAGS}; -DUSE_CUDA)

    file(GLOB_RECURSE CUDA_FILES *.cu)
    set(PROJECT_ENGINE_CUDA_LIB ${PROJECT_NAME_STR}_engine_cuda)
    cuda_add_library(${PROJECT_ENGINE_CUDA_LIB} ${CUDA_FILES})

    message(STATUS "cuda files: ${CUDA_FILES}")
    target_link_libraries(${PROJECT_ENGINE_LIB} ${PROJECT_ENGINE_CUDA_LIB})
ENDIF()


